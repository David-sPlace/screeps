{"code":"import * as tslib_1 from \"tslib\";\r\nimport { Task, TaskState } from \"./Task\";\r\nimport * as utils from \"utils/utils\";\r\nvar CreepTask = /** @class */ (function (_super) {\r\n    tslib_1.__extends(CreepTask, _super);\r\n    function CreepTask(taskInfo) {\r\n        var _this = _super.call(this, taskInfo) || this;\r\n        _this.request = taskInfo;\r\n        var creep = Game.creeps[_this.request.assignedTo];\r\n        if (creep == undefined || creep.memory == undefined)\r\n            throw \"You cant create a task with empty task info.\";\r\n        return _this;\r\n    }\r\n    CreepTask.prototype.init = function () {\r\n        // console.log(`CreepTask INIT: ${this.request.name}: ${this.request.assignedTo}`);\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (creep == undefined || creep.memory == undefined)\r\n            throw \"tried to init with an undefined creep\";\r\n    };\r\n    CreepTask.prototype.prep = function () {\r\n        // console.log(`CreepTask Prep: ${this.request.name}: ${this.request.assignedTo}`);\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (creep == undefined || creep.memory == undefined) {\r\n            console.log(\"creep was undefined - finishing task\");\r\n            this.request.status = TaskState.FINISHED;\r\n        }\r\n    };\r\n    CreepTask.prototype.start = function () {\r\n        // console.log(`CreepTask Start: ${this.request.name}: ${this.request.assignedTo}`);\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (creep == undefined || creep.memory == undefined) {\r\n            this.request.status = TaskState.FINISHED;\r\n        }\r\n    };\r\n    CreepTask.prototype.continue = function () {\r\n        // console.log(`CreepTask Continue: ${this.request.name}: ${this.request.assignedTo}`);\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (creep == undefined || creep.memory == undefined) {\r\n            this.request.status = TaskState.FINISHED;\r\n        }\r\n        if (Game.time % 5 == 0)\r\n            creep.say(\"\" + this.request.wingDing);\r\n    };\r\n    CreepTask.prototype.finish = function () {\r\n        // console.log(`CreepTask Finish: ${this.request.name}: ${this.request.assignedTo}`);\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (creep != undefined && creep.memory != undefined) {\r\n            var creepMemory = creep.memory;\r\n            creepMemory.idle = true;\r\n            creepMemory.currentTask = \"\";\r\n            creep.say(\"âœ”\");\r\n            //shouldn't need\r\n            this.request.assignedTo = \"\";\r\n        }\r\n    };\r\n    CreepTask.prototype.collectFromContainer = function (roomName, creepID) {\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (creep == undefined || creep.memory == undefined) {\r\n            this.request.status = TaskState.FINISHED;\r\n            return;\r\n        }\r\n        if (Game.time % 5 == 0)\r\n            creep.say(\"\" + this.request.wingDing);\r\n        var closestContainer = utils.findClosestContainer(roomName, creepID, true, false);\r\n        //no valid container at the moment...\r\n        if (closestContainer == undefined) {\r\n            if (Game.time % 5 == 0)\r\n                creep.say(\"\\u231B\");\r\n            //temp\r\n            creep.drop(RESOURCE_ENERGY);\r\n            return;\r\n            //continue until empty, then try again.\r\n            //if(creep.carry.energy > 0) this.request.status = TaskState.IN_PROGRESS;\r\n            //else return;\r\n        }\r\n        if (creep.withdraw(closestContainer, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(closestContainer, { visualizePathStyle: { stroke: '#ffaa00' } });\r\n        }\r\n    };\r\n    return CreepTask;\r\n}(Task));\r\nexport { CreepTask };\r\n//# sourceMappingURL=CreepTask.js.map","map":{"version":3,"file":"CreepTask.js","sourceRoot":"","sources":["../src/tasks/CreepTask.ts"],"names":[],"mappings":"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"}}

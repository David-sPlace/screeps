{"code":"var StructureTaskQueue = /** @class */ (function () {\r\n    function StructureTaskQueue() {\r\n    }\r\n    StructureTaskQueue.totalCount = function (roomName, taskName) {\r\n        if (taskName === void 0) { taskName = \"\"; }\r\n        return StructureTaskQueue.activeCount(roomName, taskName)\r\n            + StructureTaskQueue.pendingCount(roomName, taskName);\r\n    };\r\n    StructureTaskQueue.pendingCount = function (roomName, taskName) {\r\n        if (taskName === void 0) { taskName = \"\"; }\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        if (taskName == \"\") {\r\n            return roomMem.activeBuildingTaskCount;\r\n        }\r\n        else {\r\n            var count = 0;\r\n            var tasks = roomMem.pendingBuildingTasks;\r\n            for (var id in tasks) {\r\n                var task = tasks[id];\r\n                if (task.name == taskName)\r\n                    count++;\r\n            }\r\n            return count;\r\n        }\r\n    };\r\n    StructureTaskQueue.activeCount = function (roomName, taskName) {\r\n        if (taskName === void 0) { taskName = \"\"; }\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        if (taskName == \"\") {\r\n            return roomMem.activeBuildingTaskCount;\r\n        }\r\n        else {\r\n            var count = 0;\r\n            var tasks = roomMem.activeBuildingTasks;\r\n            for (var task in tasks) {\r\n                var test = tasks[task];\r\n                if (test.name == taskName)\r\n                    count++;\r\n            }\r\n            return count;\r\n        }\r\n    };\r\n    StructureTaskQueue.addPending = function (taskInfo, roomName) {\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        roomMem.pendingBuildingTasks.push(taskInfo);\r\n    };\r\n    StructureTaskQueue.startTask = function (buildingID, roomName) {\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        if (roomMem.pendingBuildingTasks.length == 0)\r\n            return;\r\n        var nextTask = roomMem.pendingBuildingTasks.shift();\r\n        // console.log(\"picked up a building task.\")\r\n        if (nextTask != undefined) {\r\n            //console.log(nextTask);\r\n            nextTask.assignedTo = buildingID;\r\n            roomMem.test[0] = nextTask;\r\n            roomMem.activeBuildingTasks[buildingID] = nextTask;\r\n            roomMem.activeBuildingTaskCount++;\r\n        }\r\n    };\r\n    StructureTaskQueue.finish = function (creepName, roomName) {\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        delete roomMem.activeBuildingTasks[creepName];\r\n        roomMem.activeBuildingTaskCount--;\r\n    };\r\n    StructureTaskQueue.allActive = function (roomName) {\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        return roomMem.activeBuildingTasks;\r\n    };\r\n    return StructureTaskQueue;\r\n}());\r\nexport { StructureTaskQueue };\r\nvar WorkerTaskQueue = /** @class */ (function () {\r\n    function WorkerTaskQueue() {\r\n    }\r\n    WorkerTaskQueue.totalCount = function (roomName, taskName) {\r\n        if (taskName === void 0) { taskName = \"\"; }\r\n        return WorkerTaskQueue.activeCount(roomName, taskName)\r\n            + WorkerTaskQueue.pendingCount(roomName, taskName);\r\n    };\r\n    WorkerTaskQueue.pendingCount = function (roomName, taskName) {\r\n        if (taskName === void 0) { taskName = \"\"; }\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        if (taskName == \"\") {\r\n            return roomMem.activeWorkerTaskCount;\r\n        }\r\n        else {\r\n            var count = 0;\r\n            var tasks = roomMem.pendingWorkerTasks;\r\n            for (var id in tasks) {\r\n                var task = tasks[id];\r\n                if (task.name == taskName)\r\n                    count++;\r\n            }\r\n            return count;\r\n        }\r\n    };\r\n    WorkerTaskQueue.activeCount = function (roomName, taskName) {\r\n        if (taskName === void 0) { taskName = \"\"; }\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        if (taskName == \"\") {\r\n            return roomMem.activeWorkerTaskCount;\r\n        }\r\n        else {\r\n            var count = 0;\r\n            var tasks = roomMem.activeWorkerTasks;\r\n            for (var task in tasks) {\r\n                var test = tasks[task];\r\n                if (test.name == taskName)\r\n                    count++;\r\n            }\r\n            return count;\r\n        }\r\n    };\r\n    WorkerTaskQueue.addPending = function (taskInfo) {\r\n        var roomMem = Game.rooms[taskInfo.roomName].memory;\r\n        roomMem.pendingWorkerTasks.push(taskInfo);\r\n    };\r\n    WorkerTaskQueue.start = function (creepName, roomName) {\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        if (roomMem.pendingWorkerTasks.length == 0)\r\n            return;\r\n        var nextTask = roomMem.pendingWorkerTasks.shift();\r\n        if (nextTask != undefined) {\r\n            //console.log(nextTask);\r\n            nextTask.assignedTo = creepName;\r\n            roomMem.test[0] = nextTask;\r\n            roomMem.activeWorkerTasks[creepName] = nextTask;\r\n            roomMem.activeWorkerTaskCount++;\r\n        }\r\n    };\r\n    WorkerTaskQueue.finish = function (creepName, roomName) {\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        delete roomMem.activeWorkerTasks[creepName];\r\n        roomMem.activeWorkerTaskCount--;\r\n    };\r\n    WorkerTaskQueue.allActive = function (roomName) {\r\n        var roomMem = Game.rooms[roomName].memory;\r\n        return roomMem.activeWorkerTasks;\r\n    };\r\n    return WorkerTaskQueue;\r\n}());\r\nexport { WorkerTaskQueue };\r\n// export class TaskQueue<T extends ICreepTask>\r\n// {\r\n// \tprivate _waitingTasks: Queue<T> = new Queue<T>();\r\n// \tprivate _runningTasks: T[] = [];\r\n// \tall(): Array<T>\r\n// \t{\r\n// \t\treturn this._waitingTasks.toArray().concat(this._runningTasks);\r\n// \t}\r\n// \tclear(): any\r\n// \t{\r\n// \t\tthis._waitingTasks.clear();\r\n// \t\tthis._runningTasks = [];\r\n// \t}\r\n// \texistingTaskCount(name: string): number\r\n// \t{\r\n// \t\treturn this.runningCount(name) + this.waitingCount(name);\r\n// \t}\r\n// \trunningCount(name: string = \"\"): number\r\n// \t{\r\n// \t\tlet count: number = 0;\r\n// \t\tfor (const value in this._runningTasks)\r\n// \t\t{\r\n// \t\t\tvar task = this._runningTasks[value];\r\n// \t\t\tif (task.taskInfo.name == name || name == \"\") count++;\r\n// \t\t}\r\n// \t\treturn count;\r\n// \t}\r\n// \twaitingCount(name: string = \"\"): number\r\n// \t{\r\n// \t\tlet count: number = 0;\r\n// \t\tvar waiting = this._waitingTasks.toArray();\r\n// \t\tfor (const value in waiting)\r\n// \t\t{\r\n// \t\t\tvar task = waiting[value];\r\n// \t\t\tif (task.taskInfo.name == name || name == \"\")\r\n// \t\t\t{\r\n// \t\t\t\tcount++;\r\n// \t\t\t}\r\n// \t\t}\r\n// \t\treturn count;\r\n// \t}\r\n// \ttotalCount(): number\r\n// \t{\r\n// \t\treturn this.waitingCount() + this.runningCount();\r\n// \t}\r\n// \taddExisting(task: T)\r\n// \t{\r\n// \t\tthis._runningTasks.push(task);\r\n// \t}\r\n// \taddNewTask(task:T)\r\n// \t{\r\n// \t\tif (task == undefined || task == null) return;\r\n// \t\tthis._waitingTasks.push(task);\r\n// \t}\r\n// \trunningTasks(): Array<T>\r\n// \t{\r\n// \t\treturn this._runningTasks;\r\n// \t}\r\n// \twaitingTasks(): Array<T>\r\n// \t{\r\n// \t\treturn this._waitingTasks.toArray();\r\n// \t}\r\n// \tany(): boolean\r\n// \t{\r\n// \t\treturn this._waitingTasks.any();\r\n// \t}\r\n// \tremove(task: T): void\r\n// \t{\r\n// \t\tthis._runningTasks = this._runningTasks.filter(obj => obj !== task);\r\n// \t}\r\n// }\r\n//# sourceMappingURL=taskQueue.js.map","map":{"version":3,"file":"taskQueue.js","sourceRoot":"","sources":["../src/utils/taskQueue.ts"],"names":[],"mappings":"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"}}

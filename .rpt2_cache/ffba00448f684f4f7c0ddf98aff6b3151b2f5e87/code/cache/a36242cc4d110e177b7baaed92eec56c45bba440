{"code":"import * as utils from \"utils/utils\";\r\nimport { RestockTask } from \"tasks/RestockTask\";\r\nimport { BuildTask, RepairTask } from \"tasks/BuildTask\";\r\nimport { UpgradeTask, ChargeRampartTask, FillTowerTask } from \"tasks/UpgradeTask\";\r\nimport { WorkerTaskQueue } from \"utils/TaskQueue\";\r\nvar TaskManager = /** @class */ (function () {\r\n    function TaskManager() {\r\n    }\r\n    TaskManager.processRoomTasks = function (roomName) {\r\n        this.addMissingTasks(roomName);\r\n        this.activateTasks(roomName);\r\n    };\r\n    TaskManager.activateTasks = function (roomName) {\r\n        var idleCreeps = utils.findIdleCreeps(roomName);\r\n        for (var id in idleCreeps) {\r\n            var creep = idleCreeps[id];\r\n            if (creep != undefined) {\r\n                var mem = creep.memory;\r\n                if (mem.idle) {\r\n                    WorkerTaskQueue.startNextTask(creep.name, roomName);\r\n                }\r\n            }\r\n        }\r\n        var stillIdleCreeps = utils.findIdleCreeps(roomName);\r\n        for (var id in stillIdleCreeps) {\r\n            var creep = stillIdleCreeps[id];\r\n            var m = creep.memory;\r\n            creep.moveTo(Game.getObjectById(m.spawnID));\r\n        }\r\n        var activeTasks = WorkerTaskQueue.allActiveTasks(roomName);\r\n        // console.log(\"There are now \" + activeTasks + \" active tasks.\")\r\n        for (var assignedName in activeTasks) {\r\n            // console.log(\"Assigned name: \" + assignedName);\r\n            var creep = Game.creeps[assignedName];\r\n            var taskInfo = activeTasks[assignedName];\r\n            switch (taskInfo.name) {\r\n                case \"Restock\":\r\n                    this.processTask(new RestockTask(taskInfo), roomName);\r\n                    break;\r\n                case \"Upgrade\":\r\n                    this.processTask(new UpgradeTask(taskInfo), roomName);\r\n                    break;\r\n                case \"Build\":\r\n                    this.processTask(new BuildTask(taskInfo), roomName);\r\n                    break;\r\n                case \"ChargeRampart\":\r\n                    this.processTask(new ChargeRampartTask(taskInfo), roomName);\r\n                    break;\r\n                case \"Repair\":\r\n                    this.processTask(new RepairTask(taskInfo), roomName);\r\n                    break;\r\n                case \"FillTower\":\r\n                    this.processTask(new FillTowerTask(taskInfo), roomName);\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    TaskManager.processTask = function (task, roomName) {\r\n        //this._workerTasks.loadTasks(roomName);\r\n        if (!task.taskInfo.started) {\r\n            task.start();\r\n        }\r\n        if (task.taskInfo.finished) {\r\n            task.finish();\r\n            WorkerTaskQueue.finishTask(task.taskInfo.assignedCreepName, roomName);\r\n        }\r\n        if (task.taskInfo.started) {\r\n            task.continue();\r\n            if (task.taskInfo.finished) {\r\n                task.finish();\r\n                WorkerTaskQueue.finishTask(task.taskInfo.assignedCreepName, roomName);\r\n            }\r\n        }\r\n    };\r\n    TaskManager.addMissingTasks = function (roomName) {\r\n        RestockTask.addRestockTasks(roomName);\r\n        UpgradeTask.addUpgradeTasks(roomName);\r\n        //ChargeRampartTask.addRepairTask(roomName);\r\n        FillTowerTask.addRepairTask(roomName);\r\n        BuildTask.addBuildTasks(roomName);\r\n        RepairTask.addRepairTask(roomName);\r\n    };\r\n    return TaskManager;\r\n}());\r\nexport { TaskManager };\r\n//# sourceMappingURL=taskManager.js.map","map":{"version":3,"file":"taskManager.js","sourceRoot":"","sources":["src/taskManager.ts"],"names":[],"mappings":"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"}}

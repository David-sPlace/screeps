{"code":"var Queue = /** @class */ (function () {\r\n    function Queue() {\r\n        this._store = [];\r\n    }\r\n    Queue.prototype.any = function () {\r\n        return this._store.length > 0;\r\n    };\r\n    Queue.prototype.push = function (val) {\r\n        this._store.push(val);\r\n    };\r\n    Queue.prototype.peek = function () {\r\n        var next = this._store.shift();\r\n        this._store.unshift(next);\r\n        return next;\r\n    };\r\n    Queue.prototype.pop = function () {\r\n        return this._store.shift();\r\n    };\r\n    Queue.prototype.length = function () {\r\n        return this._store.length;\r\n    };\r\n    return Queue;\r\n}());\r\nvar UpgradeTask = /** @class */ (function () {\r\n    function UpgradeTask(room, controller) {\r\n        this.started = false;\r\n        this.finished = false;\r\n        this._timeRequested = 0;\r\n        this._timeFinished = 0;\r\n        this._room = room;\r\n        this._controller = controller;\r\n        this._timeRequested = Game.time;\r\n    }\r\n    UpgradeTask.prototype.act = function (creep, context) {\r\n        var roomMem = this._room.memory;\r\n        var memory = creep.memory;\r\n        this.started = true;\r\n        roomMem.controllerBeingUpgraded = true;\r\n        memory.idle = false;\r\n        if (!memory.isUpgradingController && creep.carry.energy == 0) {\r\n            creep.say('ðŸ”„ harvesting energy to complete this task!');\r\n        }\r\n        if (!memory.isUpgradingController && creep.carry.energy == creep.carryCapacity) {\r\n            memory.isUpgradingController = true;\r\n            creep.say('ðŸš§ðŸ”„ upgrading controller to complete this task!');\r\n        }\r\n        if (memory.isUpgradingController) {\r\n            if (creep.upgradeController(this._controller) == ERR_NOT_IN_RANGE) {\r\n                creep.moveTo(this._controller, { visualizePathStyle: { stroke: '#ffffff' } });\r\n            }\r\n            else if (creep.carry.energy == 0) {\r\n                this.finish(creep, context);\r\n            }\r\n        }\r\n    };\r\n    UpgradeTask.prototype.finish = function (creep, contest) {\r\n        var mem = creep.memory;\r\n        this.finished = true;\r\n        this._timeFinished = Game.time;\r\n        var timeTaken = this._timeFinished - this._timeRequested;\r\n        creep.say('ðŸš§ I finished this upgrade task in ' + timeTaken + ' ticks.');\r\n        mem.idle = true;\r\n    };\r\n    return UpgradeTask;\r\n}());\r\nexport { UpgradeTask };\r\nvar TaskQueue = /** @class */ (function () {\r\n    function TaskQueue() {\r\n        this._queue = new Queue();\r\n        this._workingTasks = [];\r\n    }\r\n    TaskQueue.prototype.length = function () {\r\n        return this._queue.length();\r\n    };\r\n    TaskQueue.prototype.addItem = function (queueItem) {\r\n        if (queueItem == undefined || queueItem == null) {\r\n            console.log(\"tried to add null object to queue - not allowed.\");\r\n            return;\r\n        }\r\n        this._queue.push(queueItem);\r\n    };\r\n    TaskQueue.prototype.processing = function () {\r\n        return this._workingTasks;\r\n    };\r\n    TaskQueue.prototype.startNext = function (creep, data) {\r\n        if (this._queue.any() == false)\r\n            return;\r\n        var next = this._queue.pop();\r\n        if (next != null) {\r\n            next.act(creep, data);\r\n        }\r\n        this._workingTasks.push(next);\r\n    };\r\n    TaskQueue.prototype.finish = function (task) {\r\n        var index = this._workingTasks.indexOf(task);\r\n        if (index > -1) {\r\n            this._workingTasks.splice(index, 1);\r\n        }\r\n    };\r\n    TaskQueue.prototype.any = function () {\r\n        return this._queue.any();\r\n    };\r\n    return TaskQueue;\r\n}());\r\nexport { TaskQueue };\r\n//# sourceMappingURL=queue.js.map","map":{"version":3,"file":"queue.js","sourceRoot":"","sources":["src/queue.ts"],"names":[],"mappings":"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"}}

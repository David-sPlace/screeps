{"code":"import * as tslib_1 from \"tslib\";\r\nimport { Task } from \"./Task\";\r\nimport * as utils from \"utils/utils\";\r\nvar CreepTask = /** @class */ (function (_super) {\r\n    tslib_1.__extends(CreepTask, _super);\r\n    function CreepTask(taskInfo) {\r\n        var _this = _super.call(this, taskInfo) || this;\r\n        _this.request = taskInfo;\r\n        return _this;\r\n    }\r\n    CreepTask.prototype.start = function () {\r\n        _super.prototype.start.call(this);\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        var creepMem = creep.memory;\r\n        creepMem.currentTask = this.request.name;\r\n        creepMem.idle = false;\r\n        if (creep.carry.energy < creep.carryCapacity / 10) {\r\n            creepMem.preppingForTask = true;\r\n        }\r\n    };\r\n    CreepTask.prototype.continue = function () {\r\n        _super.prototype.continue.call(this);\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        var creepMemory = creep.memory;\r\n        if (creep === undefined || creepMemory === undefined) {\r\n            this.finish();\r\n            return;\r\n        }\r\n        if (this.request.finished)\r\n            return;\r\n        if (Game.time % 5 == 0)\r\n            creep.say(\"\" + this.request.wingDing);\r\n        if (creep.carry.energy == 0)\r\n            creepMemory.preppingForTask = true;\r\n        if (creepMemory.preppingForTask)\r\n            this.collectFromContainer(this.request.roomName, creep.id);\r\n        else\r\n            this.doWork();\r\n    };\r\n    CreepTask.prototype.finish = function () {\r\n        _super.prototype.finish.call(this);\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (creep == undefined)\r\n            return;\r\n        var mem = creep.memory;\r\n        mem.idle = true;\r\n        mem.preppingForTask = false;\r\n        mem.currentTask = \"\";\r\n        creep.say(\"âœ”\");\r\n    };\r\n    CreepTask.prototype.collectFromContainer = function (roomName, creepID) {\r\n        var creep = Game.getObjectById(creepID);\r\n        var mem = creep.memory;\r\n        if (Game.time % 5 == 0) {\r\n            creep.say(\"\" + this.request.wingDing);\r\n        }\r\n        if (creep.carry.energy == creep.carryCapacity) {\r\n            mem.preppingForTask = false;\r\n            return;\r\n        }\r\n        var closestContainer = utils.findClosestContainer(roomName, creepID, true, false);\r\n        //no valid container at the moment...\r\n        if (closestContainer == undefined) {\r\n            if (Game.time % 5 == 0)\r\n                creep.say(\"\\u231B\");\r\n            //continue until empty, then try again.\r\n            if (creep.carry.energy > 0)\r\n                mem.preppingForTask = false;\r\n            else\r\n                return;\r\n        }\r\n        if (creep.withdraw(closestContainer, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(closestContainer, { visualizePathStyle: { stroke: '#ffaa00' } });\r\n        }\r\n    };\r\n    return CreepTask;\r\n}(Task));\r\nexport { CreepTask };\r\n//# sourceMappingURL=CreepTask.js.map","map":{"version":3,"file":"CreepTask.js","sourceRoot":"","sources":["../src/tasks/CreepTask.ts"],"names":[],"mappings":"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"}}

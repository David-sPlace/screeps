{"code":"import * as tslib_1 from \"tslib\";\r\nimport { CreepTask } from \"tasks/CreepTask\";\r\nimport { CreepTaskRequest } from \"tasks/CreepTaskRequest\";\r\nimport { CreepTaskQueue } from \"../CreepTaskQueue\";\r\nimport * as utils from \"utils/utils\";\r\nvar TransferEnergyRequest = /** @class */ (function (_super) {\r\n    tslib_1.__extends(TransferEnergyRequest, _super);\r\n    function TransferEnergyRequest(roomName, transferToID, transferFromID) {\r\n        var _this = _super.call(this, roomName, \"\\u2196\", transferToID) || this;\r\n        _this.priority = 2;\r\n        _this.name = \"TransferEnergy\";\r\n        _this.requiredRole = 3 /* ROLE_WORKER */;\r\n        _this.maxConcurrentCount = 1;\r\n        _this.transferFromID = transferFromID;\r\n        return _this;\r\n    }\r\n    return TransferEnergyRequest;\r\n}(CreepTaskRequest));\r\nexport { TransferEnergyRequest };\r\nvar TransferEnergy = /** @class */ (function (_super) {\r\n    tslib_1.__extends(TransferEnergy, _super);\r\n    function TransferEnergy(taskInfo) {\r\n        return _super.call(this, taskInfo) || this;\r\n    }\r\n    TransferEnergy.prototype.continue = function () {\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (this.request.assignedTo == \"\" || creep === undefined) {\r\n            this.request.finished = true;\r\n            return;\r\n        }\r\n        var cMem = creep.memory;\r\n        if (Game.time % 5 == 0) {\r\n            creep.say(\"\" + this.request.wingDing);\r\n        }\r\n        if (creep.carry.energy == 0) {\r\n            cMem.preppingForTask = true;\r\n        }\r\n        if (creep.carry.energy == creep.carryCapacity) {\r\n            cMem.preppingForTask = false;\r\n        }\r\n        this.doWork();\r\n    };\r\n    TransferEnergy.prototype.doWork = function () {\r\n        var requestInfo = this.request;\r\n        var to = Game.getObjectById(requestInfo.targetID);\r\n        var from = Game.getObjectById(requestInfo.transferFromID);\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        var cMem = creep.memory;\r\n        if (from.store.energy == 0 && creep.carry.energy == 0) {\r\n            this.request.finished = true;\r\n            return;\r\n        }\r\n        if (from.store.energy == 0 || creep.carry.energy == creep.carryCapacity) {\r\n            cMem.preppingForTask = false;\r\n        }\r\n        if (cMem.preppingForTask && creep.withdraw(from, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(from, { visualizePathStyle: { stroke: '#ffaa00' } });\r\n        }\r\n        else if (!cMem.preppingForTask && creep.transfer(to, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(to, { visualizePathStyle: { stroke: '#ffaa00' } });\r\n        }\r\n    };\r\n    TransferEnergy.addTasks = function (roomName) {\r\n        var from;\r\n        var to;\r\n        if (roomName = \"E41S4\") {\r\n            var containers = utils.findAllContainers(roomName);\r\n            for (var key in containers) {\r\n                var value = containers[key];\r\n                //from\r\n                if (value.pos.x == 26 && value.pos.y == 26)\r\n                    from = value;\r\n                else\r\n                    to = value;\r\n            }\r\n            if (from === undefined || to === undefined) {\r\n                throw \"something didn't work (TransferEnergy.addTasks)\";\r\n            }\r\n            if (from.store.energy == 0) {\r\n                return;\r\n            }\r\n            var request = new TransferEnergyRequest(roomName, to.id, from.id);\r\n            var existingTaskCount = CreepTaskQueue.totalCount(roomName, request.name);\r\n            if (existingTaskCount < request.maxConcurrentCount) {\r\n                CreepTaskQueue.addPending(request);\r\n            }\r\n        }\r\n    };\r\n    return TransferEnergy;\r\n}(CreepTask));\r\nexport { TransferEnergy };\r\n//# sourceMappingURL=TransferEnergy.js.map","map":{"version":3,"file":"TransferEnergy.js","sourceRoot":"","sources":["../../src/tasks/creep/TransferEnergy.ts"],"names":[],"mappings":"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"}}

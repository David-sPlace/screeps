{"code":"import * as tslib_1 from \"tslib\";\r\nimport { CreepTask } from \"tasks/CreepTask\";\r\nvar CollectTask = /** @class */ (function (_super) {\r\n    tslib_1.__extends(CollectTask, _super);\r\n    function CollectTask(room, controller) {\r\n        var _this = _super.call(this, room) || this;\r\n        _this.maxConcurrentCount = 3;\r\n        _this.name = \"CollectTask\";\r\n        _this._controller = controller;\r\n        return _this;\r\n    }\r\n    CollectTask.prototype.doWork = function (creep, context) {\r\n        if (creep === undefined) {\r\n            this.finish(creep, context);\r\n            return;\r\n        }\r\n        if (creep.carry.energy < creep.carryCapacity) {\r\n            this.collect(creep, \"Deliver\", function () { });\r\n        }\r\n        else {\r\n            creep.say(\"Deliver!\");\r\n            var targets = creep.room.find(FIND_STRUCTURES, {\r\n                filter: function (structure) {\r\n                    return (structure.structureType == STRUCTURE_EXTENSION || structure.structureType == STRUCTURE_SPAWN) &&\r\n                        structure.energy < structure.energyCapacity;\r\n                }\r\n            });\r\n            if (targets.length > 0) {\r\n                if (creep.transfer(targets[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n                    creep.moveTo(targets[0], { visualizePathStyle: { stroke: '#ffffff' } });\r\n                }\r\n            }\r\n            else {\r\n                this.finish(creep, context);\r\n            }\r\n        }\r\n    };\r\n    return CollectTask;\r\n}(CreepTask));\r\nexport { CollectTask };\r\nvar BuildTask = /** @class */ (function (_super) {\r\n    tslib_1.__extends(BuildTask, _super);\r\n    function BuildTask(room, site) {\r\n        var _this = _super.call(this, room) || this;\r\n        _this.name = \"BuildTask\";\r\n        _this.maxConcurrentCount = 4;\r\n        _this._site = site;\r\n        return _this;\r\n    }\r\n    BuildTask.prototype.doWork = function (creep, context) {\r\n        if (creep === undefined) {\r\n            this.finish(creep, context);\r\n            return;\r\n        }\r\n        var creepMemory = creep.memory;\r\n        if (!creepMemory.building || creep.carry.energy == 0) {\r\n            creepMemory.building = false;\r\n            if (creep.carry.energy < creep.carryCapacity) {\r\n                this.collect(creep, \"Build\", function () { creepMemory.building = true; });\r\n            }\r\n        }\r\n        else {\r\n            creep.say(\"\\uD83D\\uDEA7 \" + this._site.progressTotal);\r\n            if (creep.build(this._site) == ERR_NOT_IN_RANGE) {\r\n                creep.moveTo(this._site, { visualizePathStyle: { stroke: '#ffffff' } });\r\n            }\r\n            else if (this._site.progressTotal == 0) {\r\n                this.finished = true;\r\n            }\r\n        }\r\n    };\r\n    return BuildTask;\r\n}(CreepTask));\r\nexport { BuildTask };\r\nvar UpgradeTask = /** @class */ (function (_super) {\r\n    tslib_1.__extends(UpgradeTask, _super);\r\n    function UpgradeTask(room, controller) {\r\n        var _this = _super.call(this, room) || this;\r\n        _this.maxConcurrentCount = 3;\r\n        _this.name = \"UpgradeTask\";\r\n        _this._controller = controller;\r\n        return _this;\r\n    }\r\n    UpgradeTask.prototype.doWork = function (creep, context) {\r\n        //console.log('upgrade task: do work')\r\n        if (creep === undefined || creep.memory === undefined) {\r\n            //our creep died or was (future) reassigned to a different task.\r\n            this.finish(creep, context);\r\n            return;\r\n        }\r\n        this.roomMemory.controllerBeingUpgraded = true;\r\n        var creepMem = creep.memory;\r\n        if (!creepMem.isUpgradingController) {\r\n            this.collect(creep, \"Upgrade\", function () { creepMem.isUpgradingController = true; });\r\n        }\r\n        if (creepMem.isUpgradingController) {\r\n            creep.say('ðŸš§Upgrade!');\r\n            if (creep.upgradeController(this._controller) == ERR_NOT_IN_RANGE) {\r\n                creep.moveTo(this._controller, { visualizePathStyle: { stroke: '#ffffff' } });\r\n            }\r\n            else if (creep.carry.energy == 0) {\r\n                this.finished = true;\r\n            }\r\n        }\r\n    };\r\n    UpgradeTask.prototype.start = function (creep, context) {\r\n        _super.prototype.start.call(this, creep, context);\r\n        this.roomMemory.controllerBeingUpgraded = true;\r\n    };\r\n    UpgradeTask.prototype.finish = function (creep, context) {\r\n        _super.prototype.finish.call(this, creep, context);\r\n        this.roomMemory.controllerBeingUpgraded = false;\r\n        if (creep !== undefined) {\r\n            var mem = creep.memory;\r\n            mem.isUpgradingController = false;\r\n            creep.say('ðŸš§ Finish!');\r\n        }\r\n    };\r\n    return UpgradeTask;\r\n}(CreepTask));\r\nexport { UpgradeTask };\r\n//# sourceMappingURL=UpgradeTask.js.map","map":{"version":3,"file":"UpgradeTask.js","sourceRoot":"","sources":["../src/tasks/UpgradeTask.ts"],"names":[],"mappings":"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"}}

{"code":"import * as tslib_1 from \"tslib\";\r\nimport { Task, TaskStatus } from \"./Task\";\r\nimport * as utils from \"utils/utils\";\r\nvar CreepTask = /** @class */ (function (_super) {\r\n    tslib_1.__extends(CreepTask, _super);\r\n    function CreepTask(request) {\r\n        var _this = _super.call(this, request) || this;\r\n        _this.request = request;\r\n        _this.creep = Game.creeps[_this.request.assignedTo];\r\n        if (_this.creep == undefined || _this.creep.memory == undefined)\r\n            throw \"You cant create a task with an undefined creep.\";\r\n        _this.creepMemory = _this.creep.memory;\r\n        return _this;\r\n    }\r\n    CreepTask.prototype.init = function () {\r\n        this.creep = Game.creeps[this.request.assignedTo];\r\n        if (this.creep == undefined || this.creep.memory == undefined)\r\n            throw \"You cant create a task with an undefined creep.\";\r\n    };\r\n    CreepTask.prototype.prepare = function () {\r\n        this.creep = Game.creeps[this.request.assignedTo];\r\n        if (this.creep == undefined || this.creep.memory == undefined) {\r\n            console.log(\"during prep, creep was undefined - finishing task\");\r\n            this.request.status = TaskStatus.FINISHED;\r\n        }\r\n        else {\r\n            this.creepMemory = this.creep.memory;\r\n        }\r\n    };\r\n    CreepTask.prototype.continue = function () {\r\n        this.creep = Game.creeps[this.request.assignedTo];\r\n        if (this.creep == undefined || this.creep.memory == undefined) {\r\n            console.log(\"during continue, creep was undefined - finishing task\");\r\n            this.request.status = TaskStatus.FINISHED;\r\n        }\r\n        else {\r\n            this.creepMemory = this.creep.memory;\r\n            if (Game.time % 5 == 0)\r\n                this.creep.say(\"\" + this.request.wingDing);\r\n        }\r\n    };\r\n    CreepTask.prototype.finish = function () {\r\n        // console.log(`CreepTask Finish: ${this.request.name}: ${this.request.assignedTo}`);\r\n        this.request.assignedTo = \"\";\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (creep != undefined && creep.memory != undefined) {\r\n            var creepMemory = creep.memory;\r\n            creepMemory.idle = true;\r\n            creepMemory.currentTask = \"\";\r\n            creep.say(\"âœ”\");\r\n            //shouldn't need\r\n        }\r\n    };\r\n    CreepTask.prototype.collectFromContainer = function (roomName, creepID) {\r\n        var creep = Game.creeps[this.request.assignedTo];\r\n        if (creep == undefined || creep.memory == undefined) {\r\n            this.request.status = TaskStatus.FINISHED;\r\n            return;\r\n        }\r\n        if (Game.time % 5 == 0)\r\n            creep.say(\"\" + this.request.wingDing);\r\n        var closestContainer = utils.findClosestContainer(roomName, creepID, true, false);\r\n        //no valid container at the moment...\r\n        if (closestContainer == undefined) {\r\n            if (Game.time % 5 == 0)\r\n                creep.say(\"\\u231B\");\r\n            //temp\r\n            creep.drop(RESOURCE_ENERGY);\r\n            return;\r\n            //continue until empty, then try again.\r\n            //if(creep.carry.energy > 0) this.request.status = TaskState.IN_PROGRESS;\r\n            //else return;\r\n        }\r\n        if (creep.withdraw(closestContainer, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n            creep.moveTo(closestContainer, { visualizePathStyle: { stroke: '#ffaa00' } });\r\n        }\r\n    };\r\n    return CreepTask;\r\n}(Task));\r\nexport { CreepTask };\r\n//# sourceMappingURL=CreepTask.js.map","map":{"version":3,"file":"CreepTask.js","sourceRoot":"","sources":["../src/tasks/CreepTask.ts"],"names":[],"mappings":"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"}}

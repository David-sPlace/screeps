{"code":"import * as tslib_1 from \"tslib\";\r\nimport { WorkerTask, WorkerTaskInfo } from \"abstract/WorkerTask\";\r\nimport { WorkerTaskQueue } from \"utils/TaskQueue\";\r\nvar UpgradeTaskInfo = /** @class */ (function (_super) {\r\n    tslib_1.__extends(UpgradeTaskInfo, _super);\r\n    function UpgradeTaskInfo(roomName, controllerID) {\r\n        var _this = _super.call(this, roomName, \"\\uD83C\\uDF87\") || this;\r\n        _this.name = \"Upgrade\";\r\n        _this.maxConcurrentCount = 5;\r\n        _this.controllerID = controllerID;\r\n        return _this;\r\n    }\r\n    return UpgradeTaskInfo;\r\n}(WorkerTaskInfo));\r\nexport { UpgradeTaskInfo };\r\nvar UpgradeTask = /** @class */ (function (_super) {\r\n    tslib_1.__extends(UpgradeTask, _super);\r\n    //taskInfo: UpgradeTaskInfo;\r\n    function UpgradeTask(taskInfo) {\r\n        return _super.call(this, taskInfo) || this;\r\n        //this.taskInfo = taskInfo as UpgradeTaskInfo;\r\n    }\r\n    UpgradeTask.prototype.doWork = function () {\r\n        var info = this.taskInfo;\r\n        var controller = Game.getObjectById(info.controllerID);\r\n        var creep = Game.creeps[this.taskInfo.assignedTo];\r\n        if (creep.upgradeController(controller) == ERR_NOT_IN_RANGE && creep.carry.energy > 0) {\r\n            creep.moveTo(controller, { visualizePathStyle: { stroke: '#ffffff' } });\r\n        }\r\n        else if (creep.carry.energy == 0) {\r\n            this.taskInfo.finished = true;\r\n            return;\r\n        }\r\n    };\r\n    UpgradeTask.addUpgradeTasks = function (roomName) {\r\n        var controller = Game.rooms[roomName].controller;\r\n        var taskInfo = new UpgradeTaskInfo(roomName, controller.id);\r\n        var existingTaskCount = WorkerTaskQueue.totalCount(roomName, taskInfo.name);\r\n        //console.log(\"there are \" + existingTaskCount + \" existing upgrade tasks.\");\r\n        var maxConcurrentCount = taskInfo.maxConcurrentCount;\r\n        var tasksNeeded = maxConcurrentCount - existingTaskCount;\r\n        //console.log(\"Upgrade tasks needed: \" + tasksNeeded);\r\n        for (var i = 0; i < tasksNeeded; i++) {\r\n            WorkerTaskQueue.addPending(taskInfo, roomName);\r\n        }\r\n    };\r\n    return UpgradeTask;\r\n}(WorkerTask));\r\nexport { UpgradeTask };\r\nvar Test = /** @class */ (function () {\r\n    function Test(mem) {\r\n        this._mem = mem;\r\n    }\r\n    return Test;\r\n}());\r\nexport { Test };\r\n//# sourceMappingURL=UpgradeTask.js.map","map":{"version":3,"file":"UpgradeTask.js","sourceRoot":"","sources":["../src/tasks/UpgradeTask.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,UAAU,EAAE,cAAc,EAAE,MAAM,qBAAqB,CAAA;AAChE,OAAO,EAAE,eAAe,EAAE,MAAM,iBAAiB,CAAC;AAGlD;IAAqC,2CAAc;IAKlD,yBAAY,QAAgB,EAAE,YAAoB;QAAlD,YACC,kBAAM,QAAQ,EAAE,cAAI,CAAC,SAErB;QAND,UAAI,GAAG,SAAS,CAAC;QACjB,wBAAkB,GAAG,CAAC,CAAC;QAItB,KAAI,CAAC,YAAY,GAAG,YAAY,CAAC;;IAClC,CAAC;IACF,sBAAC;AAAD,CAAC,AATD,CAAqC,cAAc,GASlD;;AAID;IAAiC,uCAAU;IAE1C,4BAA4B;IAC5B,qBAAY,QAAwB;eACnC,kBAAM,QAAQ,CAAC;QACf,8CAA8C;IAC/C,CAAC;IACD,4BAAM,GAAN;QAEC,IAAI,IAAI,GAAG,IAAI,CAAC,QAA2B,CAAA;QAC3C,IAAI,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAwB,CAAC;QAC9E,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAU,CAAC;QAC3D,IAAI,KAAK,CAAC,iBAAiB,CAAC,UAAU,CAAC,IAAI,gBAAgB,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EACrF;YACC,KAAK,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,kBAAkB,EAAE,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;SACxE;aACI,IAAG,KAAK,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,EAC/B;YACC,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC;YAC9B,OAAO;SACP;IAEF,CAAC;IACM,2BAAe,GAAtB,UAAuB,QAAgB;QAEtC,IAAI,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,UAAiC,CAAC;QACxE,IAAI,QAAQ,GAAG,IAAI,eAAe,CAAC,QAAQ,EAAE,UAAU,CAAC,EAAE,CAAC,CAAC;QAC5D,IAAI,iBAAiB,GAAG,eAAe,CAAC,UAAU,CAAC,QAAQ,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC;QAC5E,6EAA6E;QAE7E,IAAI,kBAAkB,GAAG,QAAQ,CAAC,kBAAkB,CAAC;QAErD,IAAI,WAAW,GAAG,kBAAkB,GAAG,iBAAiB,CAAC;QACzD,sDAAsD;QACtD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,EAAE,CAAC,EAAE,EACpC;YACC,eAAe,CAAC,UAAU,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;SAC/C;IAEF,CAAC;IACF,kBAAC;AAAD,CAAC,AAxCD,CAAiC,UAAU,GAwC1C;;AAGD;IAGC,cAAY,GAAgB;QAE3B,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;IACjB,CAAC;IACF,WAAC;AAAD,CAAC,AAPD,IAOC"}}
